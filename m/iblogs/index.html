
<!doctype html>
<html>
  <head>
    <title>
      iCarly.ga
    </title>
    <meta charset='utf-8' />
    <meta content='minimum-scale=1.0, maximum-scale=1.0, width=device-width' name='viewport' />
    <link href='/stylesheets/mobile.css' rel='stylesheet' />
    <script src='/js/jquery.js'></script>
    <script src='/js/mobile.js'></script>
  </head>
  <body>
    <header>
      <h1>
        <a href='/m/'>
          iCarly.ga mobile
        </a>
      </h1>
      <blockquote>
        Peanut Butter Love
      </blockquote>
      <img src='/images/m/header-bg.png' width='320' />
      <div class='cast'>Gibby, Spencer, Carly, Freddie, and Sam</div>
      <nav>
        <a href='/m/iblogs'>iBlogs</a>
        <a href='/m/isnaps'>iSnaps</a>
        <a href='/m/ivideo'>iVideo</a>
        <a href='/m/isongs'>iSongs</a>
      </nav>
    </header>
    <article class='iblogs'>
      <section id='loading'>
        <h3>Loading....</h3>
      </section>
      <section class='active' id='characters'>
        <div class='carly'>
          <h3>Carly</h3>
          <div class='description'>
            Carly's blog description
          </div>
          <a class='button glyph-right alt' href='#Carlys_blog'>
            read
          </a>
        </div>
        <div class='freddie'>
          <h3>Freddie</h3>
          <div class='description'>
            Freddie's blog description
          </div>
          <a class='button glyph-right alt' href='#Freddies_blog'>
            read
          </a>
        </div>
        <div class='sam'>
          <h3>Sam</h3>
          <div class='description'>
            Sam's blog description
          </div>
          <a class='button glyph-right alt' href='#Sams_blog'>
            read
          </a>
        </div>
        <div class='spencer'>
          <h3>Spencer</h3>
          <div class='description'>
            Spencer's blog description
          </div>
          <a class='button glyph-right alt' href='#Spencers_blog'>
            read
          </a>
        </div>
        <footer>
          <a class='button glyph-right' href='#archives'>
            see more blogs
          </a>
        </footer>
      </section>
      <section id='archives'>
        <h2>Blog Archives</h2>
        <div class='archives'>
          <div class='carly'>
            <a href='#archives_carly'>
              <img src='/images/m/blog/carly/thumb.jpg' />
              <span>Carly's Hot Blogs</span>
              <span class='button glyph-down'>
                1
              </span>
            </a>
          </div>
          <div class='freddie'>
            <a href='#archives_freddie'>
              <img src='/images/m/blog/freddie/thumb.jpg' />
              <span>Friddie's Awesome Blogs</span>
              <span class='button glyph-down'>
                1
              </span>
            </a>
          </div>
          <div class='sam'>
            <a href='#archives_sam'>
              <img src='/images/m/blog/sam/thumb.jpg' />
              <span>Sam's Spicy Blogs</span>
              <span class='button glyph-down'>
                1
              </span>
            </a>
          </div>
          <div class='spencer'>
            <a href='#archives_spencer'>
              <img src='/images/m/blog/spencer/thumb.jpg' />
              <span>Spencer's Weird Blogs</span>
              <span class='button glyph-down'>
                1
              </span>
            </a>
          </div>
        </div>
      </section>
      <section class='archives carly' id='archives_carly'>
        <h2>Carly's Hot Blogs</h2>
        <img src='/images/m/blog/carly/computer.png' />
        <div class='pages archives'>
          <a href='#blog_id'>
            blog title
            <span class='button glyph-right'></span>
          </a>
        </div>
        <div class='nav-pages'>
          <a class='previous button alt glyph-left' href='#'>
            prev
          </a>
          <a class='latest button alt' href='#'>
            latest
          </a>
          <a class='next button glyph-right alt' href='#'>
            next
          </a>
        </div>
      </section>
      <section class='archives freddie' id='archives_freddie'>
        <h2>Friddie's Awesome Blogs</h2>
        <img src='/images/m/blog/freddie/computer.png' />
        <div class='pages archives'>
          <a href='#blog_id'>
            blog title
            <span class='button glyph-right'></span>
          </a>
        </div>
        <div class='nav-pages'>
          <a class='previous button alt glyph-left' href='#'>
            prev
          </a>
          <a class='latest button alt' href='#'>
            latest
          </a>
          <a class='next button glyph-right alt' href='#'>
            next
          </a>
        </div>
      </section>
      <section class='archives sam' id='archives_sam'>
        <h2>Sam's Spicy Blogs</h2>
        <img src='/images/m/blog/sam/computer.png' />
        <div class='pages archives'>
          <a href='#blog_id'>
            blog title
            <span class='button glyph-right'></span>
          </a>
        </div>
        <div class='nav-pages'>
          <a class='previous button alt glyph-left' href='#'>
            prev
          </a>
          <a class='latest button alt' href='#'>
            latest
          </a>
          <a class='next button glyph-right alt' href='#'>
            next
          </a>
        </div>
      </section>
      <section class='archives spencer' id='archives_spencer'>
        <h2>Spencer's Weird Blogs</h2>
        <img src='/images/m/blog/spencer/computer.png' />
        <div class='pages archives'>
          <a href='#blog_id'>
            blog title
            <span class='button glyph-right'></span>
          </a>
        </div>
        <div class='nav-pages'>
          <a class='previous button alt glyph-left' href='#'>
            prev
          </a>
          <a class='latest button alt' href='#'>
            latest
          </a>
          <a class='next button glyph-right alt' href='#'>
            next
          </a>
        </div>
      </section>
      <section class='carly' id='entry'>
        <h2>
          Carly's blog
        </h2>
        <h3>
          Carly's blog title
        </h3>
        <h4>
          by Carly
        </h4>
        <div class='content'></div>
        <a class='button glyph-right' href='#next'>
          next blog
        </a>
      </section>
    </article>
    <script src='/js/5min/blogs_page_all_blogs.js' type='text/javascript'></script>
    <script>
        //blog page script
        $(function(){ 
          
          var names = {
              'Carly': {full_name: 'Carly Shay', blog_heading: "Hot Blogs"},
              'Freddie': {full_name: 'Freddie Benson', blog_heading: "Awesome Blog"},
              'Spencer': {full_name: 'Spencer Shay', blog_heading: "Weird Blog"},
              'Sam': {full_name: 'Sam Puckett' , blog_heading: "Spicy Blog"},
          }
          if (!window.ALL_BLOGS) {
             $.log('ALL_BLOGS data not found');
             ALL_BLOGS = {}   
          }
          var model = {
              traverse: function(){
                  var blog;
                  this.dictionary = {};
                  this.list = [];
                  this.characters = {};
                  for (var character in ALL_BLOGS) {
                      this.characters[character] = {blogs:[]}
                      for (var year in ALL_BLOGS[character]) {
                          for (var month in ALL_BLOGS[character][year]) {
                              for (var blog_id in ALL_BLOGS[character][year][month]) {
                                  if (parseInt(blog_id)) {
                                      blog = ALL_BLOGS[character][year][month][blog_id]
                                      $.extend(blog, {
                                          id: blog_id,
                                          character: character, year: year, month: month
                                      });
                                      model.list.push(blog);
                                  }
                              }
                          }
                      }
                      this.characters[character].blogs = this.characters[character].blogs.sort($.sort_by_date);
                  } 
                  this.list.sort($.sort_by_date);
                  $.each(this.list, function(index, blog) {
                      blog.index = index;
                      model.dictionary[blog.id] = blog;
                      model.characters[blog.character].blogs.push(blog);
                  })
                  return this;
              }
          }
          $.model = model.traverse();
          
          // image swap
          $(document).bind('image_swap', function () {
              //Turn bulleted lists of images into click swappible images.
              var keyword = '[image swap]';
              var prefix = 'list';
              var blog_lists_jquery = $('#entry ul');
              var list_num, index, list;
              //Loop thru every bulleted list in blog, test for keyword
              blog_lists_jquery.each(function (i) {
                  list = $(this);
                  if (list.text().indexOf(keyword) > -1) {
                      list.css({
                          'list-style-type': 'none', margin: '0', padding: '0'
                      })
                      //hide images in list
                      var list_elems = $("li", list);
                      list_elems.css({
                          display: 'none', margin: '0', cursor: 'pointer'
                      });
                      for (var li = 0; li < list_elems.length; li++) {
                          list_elems[li].className = prefix + i + '_' + li;
                          //add click events
                          if ((li + 1) < list_elems.length) {
                              list_elems.eq(li).click(function () {
                                  list_num = parseInt(this.className.substr(4, 100), 10)
                                  index = parseInt(this.className.split('_')[1], 10)
                                  $('ul li.' + prefix + list_num + '_' + (index + 1)).fadeIn('fast')
                                  this.style.display = 'none'
                              })
                          } else {
                              list_elems.eq(li).click(function () {
                                  list_num = parseInt(this.className.substr(4, 100), 10)
                                  $('ul li.' + prefix + list_num + '_1').fadeIn('fast')
                                  this.style.display = 'none'
                              })
                          }
                      }
                      // display first image in list
                      if (list_elems.length >= 2) {
                          list_elems.eq(1).css('display', 'block');
                      }
                  }
              })
          }) // end image swap
          
          $(document).bind('load_comments',function(e,data){
              if (window.comments && comments.init) {
                  $.log('loading comments for asset ' + data.id);
                  comments.setup('BlogEntry', data.id, '#comments');
                  comments.show();
              } else {
                  $.log('loading comments scripts');
                  $.getScript('/js/comment_blog_data.js', function(){ 
                      $.getScript('/js/feedback.js', function(){
                          comments.onchange = function() {
                              if ($('#comments div').length < 2) 
                                  $('#comments').hide();
                              else
                                  $('#comments').show();
                              }
                          $(document).trigger('load_comments', data);
                      }); 
                  }); 
              }
          });
          
          $(document).bind('load_asset',function(e,data){
              
              $.log('view blog '+ data.id);
              var blog = model.dictionary[data.id]
              if (blog) {
                  $.log(blog);
                  //load blog entry with ajax
                  $('section.active').removeClass('active').slideOutToSide();
                  var $loading = $('#loading');
                  var $entry = $('#entry');
                  $loading.removeClass('inactive').addClass('active').show();
                  //$.log('Calling load: ' + blog.url+' #blogs_content' );
                  $('#entry .content').load(blog.url+' #blogs_content', function(){
                      $.log('blog load complete')
                      $loading.hide().addClass('inactive');     
                      $entry.removeClass('inactive').addClass('active');
                      $('section:not(#entry)').removeClass('active').addClass('inactive');
                      $(document).trigger('image_swap');
                      $(document).trigger('load_comments', data);
                  }); 
                  $entry.attr('class', 'active ' + blog.character.toLowerCase()).stop().slideInFromSide();
                  //fill in blog information
                  $('h3:first', $entry).html(blog.title);
                  $('h2:first', $entry).html(names[blog.character].blog_heading);
                  $('h4:first', $entry).text('by ' + names[blog.character].full_name);
                  //make the last button in the entry link to the next entry
                  if (model.list[blog.index+1]) {
                      $('a.button:last', $entry).attr('href','#' + model.list[blog.index+1].id).show();
                  } else {
                      $('a.button:last', $entry).hide();
                  }
              }
          });       
          
          var newest_blogs_array = [];
          //insert blog data into page
          $.each(model.characters, function(name,character){
              var blogs = character.blogs;
              name = name.toLowerCase();
              var $char;
              if (character.blogs.length > 0) {
                  //newest blog teasers
                  $char = $('#characters .'+name);
                  $('.description', $char).text(blogs[0].teaser || blogs[0].title);
                  $('a', $char).attr('href','#'+blogs[0].id);
                  newest_blogs_array.push({name: name, date: blogs[0].date});
              };
              //archives landing
              $('#archives .'+name+' a .button').text(blogs.length);
              //archives character sections
              var page = $('#archives_'+name+' .pages').empty();
              for (var i in blogs){
                  page.append($('<a href="#'+blogs[i].id+'">' + 
                      (blogs[i].teaser || blogs[i].title) + 
                  ' <span class="glyph-right button"></span> </a>'));
              }
          }); 
          var $chars = $('#characters')
          newest_blogs_array.sort($.sort_by_date);
          $.each(newest_blogs_array, function(index, blog){
              $('.' + blog.name, $chars).insertBefore($('footer', $chars))
          });
          $.windowLoaded(function(){
              // using window load as a delay before executing these time-consuming tasks
              $('#characters .description').equalheight(10);   
              $('section.archives .pages').gpaginate();
          });
          $('#entry a.button:last').live('click', function(){
              $.scroll_page(1);
          });
          $(window).trigger('hashchange').trigger('resize')
                  
        });
    </script>
    <footer>
      <a href="/terms/privacypolicy.html">
      <b>
      Privacy Policy/Your California Privacy Rights Updated 3/18/11
      </b>
      </a>
      <a href='/terms/termsandconditions.html'>
        Please Read Our Terms of Use
      </a>
      <a href='/terms/copyrightcompliance.html'>
        Copyright Compliance Policy
      </a>
      <a href='/terms/safety.html'>
        Safety Guide
      </a>
      ©2011 Viacom International Inc. All Rights Reserved
      <h4>Friends of iCarly:</h4>
      <div class='logos'>
        <img src='/assets/1/image/2009/03/31/71008_3111973705.gif' width='69' height='26'/>
        <a href='http://www.splashface.com/'>
          <img src='/assets/1/image/2009/03/31/70889_3623639243.gif' width='92' height='38'/>
        </a>
        <a href='http://www.nick.com/common/bumpers/fullpage/icarly.jhtml?destination=http://www.nick.com' rel='external'>
          <img src='/assets/1/image/2009/03/31/70859_1306697130.gif' width='106' height='28'/>
        </a>
      </div>
    </footer>
  </body>
</html>
